RewriteEngine On

# Pass Authorization header to PHP (for JWT)
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule ^(.*)$ - [E=HTTP_AUTHORIZATION:%1]

# Redirect all requests to index.php if file/folder does not exist
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?route=$1 [QSA,L]

# Allow direct access to uploads and static files (user/uploads and vendor/uploads from any path)
RewriteCond %{REQUEST_URI} /(user|vendor)/uploads/
RewriteRule . - [L]

# Allow direct access to existing PHP files
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^(.+\.php)$ $1 [L]
